<!DOCTYPE html>
<html manifest="$1.appcache">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0">
    <title>$2</title>
    <link type="text/css" rel="stylesheet" href="css/style.css">
    <link type="text/css" rel="stylesheet" href="css/$1.css">
    <link rel="author" href="https://plus.google.com/+SeanMcBeth/posts">
    <meta property="og:locale" content="en_US">
    <script type="text/javascript" src="js/psychologist/core.js"></script>
    <script type="text/javascript">
        var ctrls;
        psych(function(){
            ctrls = ctrls || findEverything();
            
            function closeReloadMessage(showLogin){
                ctrls.appCacheStatus.style.display = "none";
                ctrls.downloadProgress.style.display = "none";
                ctrls.loginForm.style.display = showLogin ? "" : "none";
                if(showLogin){
                    waitFor(
                        function(){ return ctrls.tryLogin; },
                        function(){ ctrls.tryLogin(); }, 
                        125, 8
                    );
                }
            }

            function showReload(message){
                ctrls.appCacheMessage.style.display = "none";
                ctrls.appCacheReload.style.display = "";
                ctrls.reloadAppButton.innerHTML = message;
                E(ctrls.reloadAppButton, "click", reloadPage, false);                
                E(ctrls.dismissAppUpdateButton, "click", closeReloadMessage.bind(window, false), false);
            };
            
            function showAppCacheMessage(msg){
                ctrls.appCacheMessage.innerHTML = msg;
            }
            
            function appCacheReady(msg){
                showAppCacheMessage(msg);
                closeReloadMessage(true);
            }
            
            function showAppCacheProgress(evt){ 
                var p = evt.loaded / evt.total;
                ctrls.downloadProgress.style.opacity = 1 - p;
                showAppCacheMessage(fmt("Checking for application update $1.0%... please wait", 100 * p));
            }
            
            E(applicationCache, "checking", showAppCacheMessage.bind(window, "Checking for application update... please wait."), false);
            E(applicationCache, "downloading", showAppCacheMessage.bind(window, "Downloading update now... please wait."), false); 
            E(applicationCache, "progress", showAppCacheProgress.bind(window), false);
            E(applicationCache, "error", showReload.bind(window, "Error downloading update. Try again.", false), false);
            E(applicationCache, "updateready", showReload.bind(window, "Download complete. Restart application.", false), false);           
            E(applicationCache, "noupdate", appCacheReady.bind(window, "No update found."), false);            
            E(applicationCache, "cached", appCacheReady.bind(window, "Application cached."), false);
        }.bind(window));
    </script>
</head>
<body>
    <div id="onScreenControls">
        <a id="github" href="https://github.com/capnmidnight/VR"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub"></a>
        <a class="primary button" id="menuButton" title="menu"></a>
        <a class="primary button" id="fsButton" title="fullscreen"></a>
    </div>
    <div class="progressBar" id="downloadProgress" style="width:100%; background-color:#000; opacity: 1"></div>
    <section id="options">
        <a class="primary button closeSectionButton altClose">X</a>

        <h1>$2</h1>

        <div class="tabSet">
            <label>Login</label>
            <div>
                <div id="appCacheStatus">
                    <div id="appCacheMessage"></div>
                    <div id="appCacheReload" style="display:none;">
                        <a class="primary button" id="reloadAppButton"></a>
                        <a class="secondary button" id="dismissAppUpdateButton">Dismiss.</a>
                    </div>
                </div>
                
                <div id="loginForm" style="display:none;">
                    <input type="text" id="userNameField" placeholder="<user name>"><br />
                    <input type="text" id="emailField" placeholder="<e-mail>"><br />
                    <input type="password" id="passwordField" placeholder="<password>"><br />
                    <select id="deviceTypes"></select><br />
                    <input type="checkbox" id="defaultDisplay" checked>
                    <label for="defaultDisplay" title="Generally deselect this on a smartphone that you are pairing with a PC.">Use this device as the default display.</label><br>
                    <input type="checkbox" id="autoLogin" checked>
                    <label for="autoLogin">Stay logged in.</label><br>
                    <a class="primary button" id="connectButton">Connect to Server</a>
                </div>
                
                <p>
                    If this is you're first time joining, a new user account 
                    will be created for you.
                </p>
                <p>
                    Login from multiple devices to use them together, 
                    e.g. combine keyboard and mouse actions from your PC with
                    motion tracking and VR view on your smartphone.
                </p>                
            </div>
            
            <label>Chat</label>
            <div>
                <div id="chatStatus">
                    <div id="chatLog"></div>
                    <div id="userList" data-skipcache="true"></div>
                </div>
                <input type="text" id="textEntry" placeholder="<type message and hit enter>" size="30" data-skipcache="true" />
            </div>

            <label>Controls</label>
            <table>
                <thead>
                    <tr>
                        <th>Command</th>
                        <th>Keyboard</th>
                        <th>Mouse</th>
                        <th>Touch</th>
                        <th>Gamepad</th>
                        <th>Speech</th>
                        <th>Leap Motion</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="alternateRow">
                        <td>View options</td>
                        <td>~</td>
                        <td>click three bar icon</td>
                        <td>tap three bar icon</td>
                        <td>Select button</td>
                        <td>say "options"</td>
                        <td>--</td>
                    </tr>
                    <tr>
                        <td>Move forward</td>
                        <td>W, up arrow</td>
                        <td>--</td>
                        <td>touch-drag down</td>
                        <td>left-stick up</td>
                        <td>--</td>
                        <td>--</td>
                    </tr>
                    <tr class="alternateRow">
                        <td>Move backward</td>
                        <td>S, down arrow</td>
                        <td>--</td>
                        <td>touch-drag up</td>
                        <td>left-stick down</td>
                        <td>--</td>
                        <td>--</td>
                    </tr>
                    <tr>
                        <td>Strafe left</td>
                        <td>A, left arrow</td>
                        <td>--</td>
                        <td>--</td>
                        <td>left-stick left</td>
                        <td>--</td>
                        <td>--</td>
                    </tr>
                    <tr class="alternateRow">
                        <td>Strafe right</td>
                        <td>D, right arrow</td>
                        <td>--</td>
                        <td>--</td>
                        <td>left-stick right</td>
                        <td>--</td>
                        <td>--</td>
                    </tr>
                    <tr>
                        <td>Turn left</td>
                        <td>--</td>
                        <td>move left</td>
                        <td>touch-drag right</td>
                        <td>right-stick left</td>
                        <td>--</td>
                        <td>--</td>
                    </tr>
                    <tr class="alternateRow">
                        <td>Turn right</td>
                        <td>--</td>
                        <td>move right</td>
                        <td>touch-drag left</td>
                        <td>right-stick right</td>
                        <td>--</td>
                        <td>--</td>
                    </tr>
                    <tr>
                        <td>Look up</td>
                        <td>--</td>
                        <td>move down</td>
                        <td>--</td>
                        <td>right-stick down</td>
                        <td>--</td>
                        <td>--</td>
                    </tr>
                    <tr class="alternateRow">
                        <td>Look down</td>
                        <td>--</td>
                        <td>move up</td>
                        <td>--</td>
                        <td>right-stick up</td>
                        <td>--</td>
                        <td>--</td>
                    </tr>
                    <tr>
                        <td>Jump</td>
                        <td>spacebar</td>
                        <td>middle-click</td>
                        <td>--</td>
                        <td>A-button</td>
                        <td>say "jump"</td>
                        <td>--</td>
                    </tr>
                    <tr class="alternateRow">
                        <td>Chat entry</td>
                        <td>T, then type text</td>
                        <td>--</td>
                        <td>tap speech balloon icon, type text in textbox</td>
                        <td>--</td>
                        <td>say "message", then speak message</td>
                        <td>--</td>
                    </tr>
                    <tr>
                        <td>Cancel chat</td>
                        <td>ESC</td>
                        <td>--</td>
                        <td>--</td>
                        <td>--</td>
                        <td>--</td>
                        <td>--</td>
                    </tr>
                    <tr class="alternateRow">
                        <td>Send chat</td>
                        <td>Enter</td>
                        <td>--</td>
                        <td>Enter</td>
                        <td>--</td>
                        <td>finish speaking</td>
                        <td>--</td>
                    </tr>
                </tbody>
            </table>

            <label>Input</label>
            <table>
                <thead>
                    <tr>
                        <th>Input Type</th>
                        <th>Enable</th>
                        <th>Transmit</th>
                        <th>Receive</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="inputOptions">
                    <tr>
                        <td>Speech</td>
                        <td><input type="checkbox" id="speechEnable" /></td>
                        <td><input type="checkbox" id="speechTransmit" /></td>
                        <td><input type="checkbox" id="speechReceive" /></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>Keyboard</td>
                        <td><input type="checkbox" id="keyboardEnable" checked /></td>
                        <td><input type="checkbox" id="keyboardTransmit" checked /></td>
                        <td><input type="checkbox" id="keyboardReceive" checked /></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>Mouse</td>
                        <td><input type="checkbox" id="mouseEnable" checked /></td>
                        <td><input type="checkbox" id="mouseTransmit" checked /></td>
                        <td><input type="checkbox" id="mouseReceive" checked /></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>Leap Motion</td>
                        <td><input type="checkbox" id="leapEnable" checked /></td>
                        <td><input type="checkbox" id="leapTransmit" checked /></td>
                        <td><input type="checkbox" id="leapReceive" checked /></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>Gamepad</td>
                        <td><input type="checkbox" id="gamepadEnable" checked /></td>
                        <td><input type="checkbox" id="gamepadTransmit" checked /></td>
                        <td><input type="checkbox" id="gamepadReceive" checked /></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>Touch</td>
                        <td><input type="checkbox" id="touchEnable" checked /></td>
                        <td><input type="checkbox" id="touchTransmit" checked /></td>
                        <td><input type="checkbox" id="touchReceive" checked /></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>Head</td>
                        <td><input type="checkbox" id="headEnable" checked /></td>
                        <td><input type="checkbox" id="headTransmit" checked /></td>
                        <td><input type="checkbox" id="headReceive" checked /></td>
                        <td><a class="primary button" id="headZero">Zero</a></td>
                    </tr>
                </tbody>
            </table>

            <label>Graphics</label>
            <table>
                <tbody>
                    <tr><td><select id="renderingStyle" style="width:100%;font-size:200%;">
                        <option value="regular">Use Regular Rendering</option>
                        <option value="rift">Use Stereo Rendering with Barrel Distortion</option>
                        <option value="anaglyph">Use Cyan/Red Anaglyph Rendering</option>
                        <option value="stereo">Use Basic Stereo Rendering</option>
                    </select></td></tr>                        
                    <tr><td><a class="primary button" id="fullScreenButton">Toggle Full Screen</a></td></tr>
                    <tr><td><a class="primary button" id="pointerLockButton">Set Pointer Lock (and close options window)</a></td></tr>
                </tbody>
            </table>
        </div>
        <a class="primary button closeSectionButton">Close</a>
    </section>
    <script type="text/javascript" src="lib/three/three.js"></script>
    <script type="text/javascript" src="lib/three/StereoEffect.js"></script>
    <script type="text/javascript" src="lib/three/OculusRiftEffect.js"></script>
    <script type="text/javascript" src="lib/three/AnaglyphEffect.js"></script>
    <script type="text/javascript" src="lib/three/ColladaLoader.js"></script>
    <script type="text/javascript" src="lib/physics/cannon.min.js"></script>
    <script type="text/javascript" src="lib/leap-0.6.3.min.js"></script>
    <script type="text/javascript" src="lib/sha512.js"></script>
    <script type="text/javascript" src="lib/socket.io.js"></script>
    <script type="text/javascript" src="js/oscope/oscope.client.js"></script>
    <script type="text/javascript" src="js/WebRTCSocket.js"></script>
    <script type="text/javascript" src="js/ModelLoader.js"></script>
    <script type="text/javascript" src="js/input/NetworkedInput.js"></script>
    <script type="text/javascript" src="js/input/ButtonAndAxisInput.js"></script>
    <script type="text/javascript" src="js/input/SpeechInput.js"></script>
    <script type="text/javascript" src="js/input/GamepadInput.js"></script>
    <script type="text/javascript" src="js/input/KeyboardInput.js"></script>
    <script type="text/javascript" src="js/input/MotionInput.js"></script>
    <script type="text/javascript" src="js/input/MouseInput.js"></script>
    <script type="text/javascript" src="js/input/TouchInput.js"></script>
    <script type="text/javascript" src="js/input/LeapMotionInput.js"></script>
    <script type="text/javascript" src="js/output/Audio3DOutput.js"></script>
    <script type="text/javascript" src="js/output/SpeechOutput.js"></script>
    <script type="text/javascript" src="js/psychologist/ui/html/StateList.js"></script>
    <script type="text/javascript" src="js/psychologist/ui/html/TabSet.js"></script>
    <script type="text/javascript" src="js/psychologist/ui/vr/Text.js"></script>
    <script type="text/javascript" src="js/psychologist/ui/vr/Button.js"></script>
    <script type="text/javascript" src="js/controllers/$1.js"></script>
</body>
</html>
